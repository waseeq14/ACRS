import styles from './styles.module.css'

const code =
  'int main() {\n\tint *a = malloc(0x50);\n\tfree(a);\n\tint *d = malloc(0x50);\n\tfree(d);\n\tfree(d);\n\tprint(a);\n\treturn 1;\n}'

const statistics = 'Vulnerability found: Use After Free\n\nCWE-ID : CWE-416'
const staticAnalysis =
  "[*] Starting analysis from 'main' function:\n\n\nAnalyzing function 'main'\nAssigned variable: a\nAssigned variable: d\nDouble-Free Warning: 'd' freed again at line 7\nUse-After-Free detected: 'a' at line 8, originally freed at line 4\nCritical function detected: 'malloc' at line 3\nCritical function detected: 'free' at line 4\nCritical function detected: 'malloc' at line 5\nCritical function detected: 'free' at line 6\nCritical function detected: 'free' at line 7\nCritical function detected: 'printf' at line 8"
const dynamicAnalysis =
  "LLM Response:\n\nVulnerability Assessment: Use After Free\n\nExtracted Vulnerability Assessment Keyword: 'Use After Free'\n\nSearching for CWEs matching keyword: 'Use After Free'\n\nMatching CWE-IDs for keyword 'Use After Free':\nCWE-ID: 416, Name: Use After Free\n\nVulnerable function found: printf at address 0x400000\nStarting symbolic execution at address 0x400000..."

export default function VulnerabilityAssessment() {
  return (
    <>
      <div className={styles.card}>
        <textarea placeholder='Enter vulnerable code'>{code}</textarea>
        <div className={styles.buttonLayout}>
          <button>Upload</button>
          <button>Submit</button>
        </div>
      </div>
      <div style={{ height: '1rem' }}></div>
      <div class={styles.cards}>
        <div class={styles.card}>
          <h2>Statistics</h2>
          <textarea className={styles.whiteTextArea} readOnly={true}>
            {statistics}
          </textarea>
        </div>
        <div class={styles.card}>
          <h2>Static Analysis</h2>
          <textarea className={styles.whiteTextArea} readOnly={true}>
            {staticAnalysis}
          </textarea>
        </div>
        <div class={styles.card}>
          <h2>Dynamic Analysis</h2>
          <textarea className={styles.whiteTextArea} readOnly={true}>
            {dynamicAnalysis}
          </textarea>
        </div>
      </div>
    </>
  )
}
